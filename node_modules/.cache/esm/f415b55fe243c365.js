let transactions,accounts,login,UV_UDP_REUSEADDR;_e24‍.x([["default",()=>_e24‍.o]]);_e24‍.w("../model/transaction.model",[["default",["transactions"],function(v){transactions=v}]]);_e24‍.w("../model/account.model",[["default",["accounts"],function(v){accounts=v}]]);_e24‍.w("../model/login",[["default",["login"],function(v){login=v}]]);_e24‍.w("constants",[["UV_UDP_REUSEADDR",["UV_UDP_REUSEADDR"],function(v){UV_UDP_REUSEADDR=v}]]);





class transactioncontroller {
    static getTransaction(req, res) {
      return res.json
      ({
        status:200,
        data:transactions
      });
    }
    static creditAccount(req,res){
        const acc=accounts.find(acc=>acc.accountnumber===req.parms.id);
        const signi = login.find(u => u.id === req.body.staffid);
        if(acc){
            const oldBalance=acc.balance;
            const newBalance=oldBalance+req.body.amout;
            const tra={
                id:Date.now(),
                accountnumber:acc.accountnumber,
                amout:req.body.amount,
                cashier:u.id,
                transactiontype:"credit",
                oldBalance:oldBalance,
                newBalance:newBalance
            }
            transactions.push(tra);
            res.status.send({
                status:200,
                data:tra
            })
        }
    }
    static DebitAccount(req,res){
        const acc=accounts.find(acc=>acc.accountnumber===req.parms.id);
        const signi = login.find(u => u.id === req.body.staffid);
        if(acc){
            const oldBalance=acc.balance;
            const newBalance=oldBalance-req.body.amout;
            if(newBalance>0){
            const tra={
                id:Date.now(),
                accountnumber:acc.accountnumber,
                amout:req.body.amount,
                cashier:u.id,
                transactiontype:"credit",
                oldBalance:oldBalance,
                newBalance:newBalance
            }
            transactions.push(tra);
            res.status.send({
                status:200,
                data:tra
            });
        }else{
            res.status(400).send({
                status:400,
                error:`enter ammount grater than ${oldBalance}`
            });
        }
        }else{
            res.status(400).send({
                status:400,
                error:"Account not found"
            });
        }
    }

}
_e24‍.d(transactioncontroller); 